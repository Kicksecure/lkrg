/*
 * pi3's Linux kernel Runtime Guard
 *
 * Component:
 *  - Generic install and uinstall function.
 *
 * Notes:
 *  - None
 *
 * Caveats:
 *  - None
 *
 * Timeline:
 *  - Created: 4.V.2020
 *
 * Author:
 *  - Mariusz Zaborski (https://oshogbo.vexillium.org/)
 *
 */

#ifndef P_LKRG_EXPLOIT_DETECTION_INSTALL_H
#define P_LKRG_EXPLOIT_DETECTION_INSTALL_H

int p_install_hook(struct kretprobe *kretprobe, char *state);
void p_uninstall_hook(struct kretprobe *kretprobe, char *state);

#define GENERATE_INSTALL_FUNC(name)		                                                \
	int p_install_##name##_hook(void) {	                                                \
		return p_install_hook(&p_##name##_kretprobe, &p_##name##_kretprobe_state);	    \
	}					                                                                \
						                                                                \
	void p_uninstall_##name##_hook(void) {	                                            \
		return p_uninstall_hook(&p_##name##_kretprobe, &p_##name##_kretprobe_state);	\
	}

#endif
